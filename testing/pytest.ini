[pytest]
# DS01 Infrastructure Test Configuration
testpaths = unit component integration e2e runtime
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Markers for test categorization
markers =
    unit: Unit tests (fast, isolated, mocked dependencies)
    component: Component tests (single component with real dependencies)
    integration: Integration tests (multiple components together)
    e2e: End-to-end tests (full user workflows)
    slow: Slow tests (skip with -m "not slow")
    requires_docker: Tests requiring Docker daemon
    requires_gpu: Tests requiring GPU/nvidia-smi
    requires_root: Tests requiring root privileges
    runtime: Runtime tests (real system, real containers, ~15 min, requires sudo)

# Default options
addopts = -v --tb=short -m "not runtime"

# Ignore legacy test files during migration
norecursedirs =
    cleanup-automation
    validation
    gpu-allocation
    layered-architecture
    functional
    .git

# Ignore legacy test files that reference old modules
ignore_glob =
    **/test_gpu_allocator_mig_detection.py
    **/test_gpu_allocator_functional.py
