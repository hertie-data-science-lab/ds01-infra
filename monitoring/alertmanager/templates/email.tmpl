{{ define "email.default.subject" }}
[DS01] {{ .Status | toUpper }}{{ if eq .Status "firing" }} ({{ .Alerts.Firing | len }}){{ end }}: {{ .GroupLabels.SortedPairs.Values | join " " }}
{{ end }}

{{ define "email.default.html" }}
<!DOCTYPE html>
<html>
<head>
<style>
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
.container { max-width: 600px; margin: 0 auto; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.header { padding: 20px; color: white; }
.header.firing { background: #dc3545; }
.header.resolved { background: #28a745; }
.header h1 { margin: 0; font-size: 20px; }
.alert { padding: 15px 20px; border-bottom: 1px solid #eee; }
.alert:last-child { border-bottom: none; }
.alert-title { font-weight: 600; margin-bottom: 8px; }
.alert-description { color: #666; margin-bottom: 10px; }
.labels { display: flex; flex-wrap: wrap; gap: 5px; }
.label { background: #e9ecef; padding: 2px 8px; border-radius: 4px; font-size: 12px; }
.severity-critical { background: #f8d7da; color: #721c24; }
.severity-warning { background: #fff3cd; color: #856404; }
.severity-info { background: #d1ecf1; color: #0c5460; }
.footer { padding: 15px 20px; background: #f8f9fa; font-size: 12px; color: #666; }
</style>
</head>
<body>
<div class="container">
  <div class="header {{ .Status }}">
    <h1>DS01 Alert: {{ .Status | title }}</h1>
  </div>

  {{ if gt (len .Alerts.Firing) 0 }}
  {{ range .Alerts.Firing }}
  <div class="alert">
    <div class="alert-title">{{ .Labels.alertname }}</div>
    {{ if .Annotations.description }}
    <div class="alert-description">{{ .Annotations.description }}</div>
    {{ end }}
    <div class="labels">
      <span class="label severity-{{ .Labels.severity }}">{{ .Labels.severity }}</span>
      {{ range .Labels.SortedPairs }}
        {{ if and (ne .Name "alertname") (ne .Name "severity") }}
        <span class="label">{{ .Name }}: {{ .Value }}</span>
        {{ end }}
      {{ end }}
    </div>
  </div>
  {{ end }}
  {{ end }}

  {{ if gt (len .Alerts.Resolved) 0 }}
  {{ range .Alerts.Resolved }}
  <div class="alert" style="background: #f8fff8;">
    <div class="alert-title" style="color: #28a745;">RESOLVED: {{ .Labels.alertname }}</div>
    {{ if .Annotations.description }}
    <div class="alert-description">{{ .Annotations.description }}</div>
    {{ end }}
  </div>
  {{ end }}
  {{ end }}

  <div class="footer">
    DS01 GPU Server Monitoring | <a href="http://localhost:9090">Prometheus</a> | <a href="http://localhost:3000">Grafana</a>
  </div>
</div>
</body>
</html>
{{ end }}
